---
title: 'Transferring stuff with Swig'
description: '\"Give and it will be given to you\" - Ancient Green Manuscripts'
---

This guide walks through different ways to perform transfers using Swig, progressing from basic to more advanced patterns.
You can find all example code in the [swig-ts/examples/classic/transfer](https://github.com/anagrambuild/swig-ts/tree/main/examples/classic/transfer) directory or for kit refer to this directory [swig-ts/examples/kit/transfer](https://github.com/anagrambuild/swig-ts/tree/main/examples/kit/transfer).

<Tip>Examples with svm in the file name use LiteSVM for testing. Those without svm in the file name use a local validator. Which you can run with the `bun start-validator` command.</Tip>

## Basic Transfer with Ed25519 Keys

The simplest way to use Swig is with standard Ed25519 keypairs. Here are the key parts:

<Tabs>
  <Tab title="Classic">
```ts
// Key Setup - Using standard Solana keypairs
const userRootKeypair = Keypair.generate();
const dappAuthorityKeypair = Keypair.generate();

// Create a new Swig account with root authority
const rootActions = Actions.set().all().get();
const createSwigInstruction = await getCreateSwigInstruction({
  payer: userRootKeypair.publicKey,
  authorityInfo: createEd25519AuthorityInfo(userRootKeypair.publicKey),
  id,
  actions: rootActions,
});

// Add a new authority with a spending limit
const dappActions = Actions.set().solLimit({ amount: BigInt(0.1 * LAMPORTS_PER_SOL) }).get();
const addAuthorityInstructions = await getAddAuthorityInstructions(
  swig,
  rootRole.id,
  createEd25519AuthorityInfo(dappAuthorityKeypair.publicKey),
  dappActions,
);

// Transfer SOL with Swig authority
const transferIx = SystemProgram.transfer({
  fromPubkey: swigAddress,
  toPubkey: dappAuthorityKeypair.publicKey,
  lamports: 0.1 * LAMPORTS_PER_SOL,
});

const signedInstructions = await getSignInstructions(
  swig,
  dappRole.id,
  [transferIx]
);

await sendTransaction(connection, signedInstructions, dappAuthorityKeypair);
```
  </Tab>
  <Tab title="Kit">
```ts
// Key Setup - Using @solana/kit KeyPairSigner
const userRoot = await generateKeyPairSigner();
const dappAuthority = await generateKeyPairSigner();

// Create Swig with Ed25519 authority
const rootActions = Actions.set().all().get();
const createSwigInstruction = await getCreateSwigInstruction({
  payer: userRoot.address,
  authorityInfo: createEd25519AuthorityInfo(userRoot.address),
  id,
  actions: rootActions,
});

// Add a dapp authority with spending limit
const dappActions = Actions.set().solLimit({ amount: BigInt(0.1 * LAMPORTS_PER_SOL) }).get();
const addAuthorityInstructions = await getAddAuthorityInstructions(
  swig,
  rootRole.id,
  createEd25519AuthorityInfo(dappAuthority.address),
  dappActions,
);

// Transfer SOL
const transferInstruction = getSolTransferInstruction({
  fromAddress: swigAddress,
  toAddress: dappAuthority.address,
  lamports: 0.1 * LAMPORTS_PER_SOL,
});

const signedInstructions = await getSignInstructions(
  swig,
  dappRole.id,
  [transferInstruction],
);

await sendTransaction(connection, signedInstructions, dappAuthority);
```

  </Tab>
</Tabs>

You can find the complete example in `transfer-local.ts` and `transfer-svm.ts` for local and LiteSVM environments respectively.

---

## Using Secp256k1 Keys (EVM Compatible)

For EVM compatibility, Swig supports Secp256k1 keys. Note the key differences from the Ed25519 example:

```ts
// Key Setup - Using Ethereum wallet
const userWallet = Wallet.generate(); // ðŸ‘ˆ EVM wallet instead of Solana Keypair

// Create Swig with Secp256k1 authority
const createSwigInstruction = Swig.create({
  authorityInfo: createSecp256k1AuthorityInfo(userWallet.getPublicKey()),
  id,
  payer: payer.publicKey, // Still needs a Solana account for fees
  actions: rootActions,
});

// Sign using the Secp256k1 private key
const signingFn = getSigningFnForSecp256k1PrivateKey(
  userWallet.getPrivateKey(),
);

const signedTransfer = await signInstruction(
  rootRole,
  signer.publicKey,
  [transfer],
  {
    currentSlot: BigInt(slot),
    signingFn,
  },
);
```

Check out `transfer-local-secp.ts` and `transfer-svm-secp.ts` for complete examples.

---

## Using Viem for Ethereum Wallet Integration

For a more complete Ethereum wallet integration using Viem:

```ts
// Using Viem account
const privateKeyAccount = privateKeyToAccount(userWallet.getPrivateKeyString());

const createSwigInstruction = Swig.create({
  authorityInfo: createSecp256k1AuthorityInfo(privateKeyAccount.publicKey),
  id,
  payer: transactionPayer.publicKey,
  actions: rootActions,
});

const signTransfer = await signInstruction(
  rootRole,
  transactionPayer.publicKey,
  [transfer],
  {
    currentSlot: svm.getClock().slot,
    signingFn: viemSign,
  },
);
```

See `transfer-svm-viem.ts` for the full working code.

---

## Using Sessions for Enhanced Security

Sessions allow limited, temporary authority:

### Ed25519 Sessions

```ts
const sessionAuthority = Keypair.generate();
const sessionDuration = 100n; // slots

const addSessionInstruction = await addAuthorityInstruction(
  rootRole,
  signer.publicKey,
  {
    currentSlot: BigInt(slot),
    signingFn: ed25519SigningFn,
    authorityInfo: createEd25519AuthorityInfo(sessionAuthority.publicKey),
    actions: sessionActions,
    duration: sessionDuration,
  },
);
```

### Secp256k1 Sessions

```ts
const sessionWallet = Wallet.generate();
const sessionDuration = 100n;

const addSessionInstruction = await addAuthorityInstruction(
  rootRole,
  signer.publicKey,
  {
    currentSlot: BigInt(slot),
    signingFn: secp256k1SigningFn,
    authorityInfo: createSecp256k1AuthorityInfo(sessionWallet.getPublicKey()),
    actions: sessionActions,
    duration: sessionDuration,
  },
);
```

---

## Testing Environment Options

* **Local Validator**: Use the `transfer-local-*` examples
* **LiteSVM**: Use the `transfer-svm-*` examples
* **Devnet**: Change connection URL to `https://api.devnet.solana.com`

LiteSVM is recommended for the fastest feedback. Use local validator/devnet for integration-level testing.
